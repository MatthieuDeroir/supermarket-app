# release.yml

release:
  stage: release
  dependencies:
    - test-request-prod-backend-blue
    - test-request-prod-frontend-blue
  script:
    - echo "Creating GitLab release..."
    - export RELEASE_TAG=$(date +%Y.%m.%d.%H%M%S)
    - git tag $RELEASE_TAG
    - git push origin $RELEASE_TAG
    - curl --request POST --header "PRIVATE-TOKEN: $GITLAB_PRIVATE_TOKEN" --data "name=Release $RELEASE_TAG&tag_name=$RELEASE_TAG&description=Automated release $RELEASE_TAG" "$CI_API_V4_URL/projects/$CI_PROJECT_ID/releases"
